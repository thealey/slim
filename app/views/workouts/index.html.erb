<h1>
  <%= image_tag @person.gravatar_url if Person.online %> <%= @person.name! %> 
  <small>
    <% workout_goal = @person.workout_goal || 300 %>
    7 day workout goal:<strong> <%= workout_goal.to_s %></strong>
  </small>
</h1>

<% if person_signed_in? %>
  <span class='pull-right'>
    <p>
    <%= link_to 'New Workout', new_workout_path, :class => 'btn btn-primary' %>
    </p>
  </span>
<% end %>

<%
  GoogleChart::LineChart.new('320x200', "Line Chart", false) do |lc|
    lc.data "Trend 1", [5,4,3,1,3,5,6], '0000ff'
    lc.show_legend = true
    lc.data "Trend 2", [1,2,3,4,5,6], '00ff00'
    lc.data "Trend 3", [6,5,4,3,2,1], 'ff0000'
    lc.axis :y, :range => [0,6], :color => 'ff00ff', :font_size => 16, :alignment => :center
    lc.axis :x, :range => [0,6], :color => '00ffff', :font_size => 16, :alignment => :center
    lc.grid :x_step => 100.0/6.0, :y_step => 100.0/6.0, :length_segment => 1, :length_blank => 0
    puts "\nLine Chart"
    puts lc.to_url
  end
%>

<table class='table'>
  <tr>
    <th>When</th>
    <th>Rating</th>
    <th>Description</th>
    <th>7 Day Score</th>
    <th>Grade</th>
    <th></th>
  </tr>

  <% @workouts.each do |workout| %>
    <tr>
      <td>
        <% if workout.workout_date %>
          <%= workout.workout_date.to_s(:slim) %>
          (<%= time_ago_in_words workout.workout_date %> ago)
        <% else %>
          -
        <% end %>
      </td>
      <td><%= workout.rating.nil? ? '-' : workout.rating %></td>
      <td><%= workout.description.nil? ? '-' : workout.description %></td>
      <td>
        <%= @against_goal[workout.workout_date.to_date].to_s %> /
        <%= @scores[workout.workout_date.to_date].to_s %>%
      </td>
      <td><strong><%= Person.grade(@scores[workout.workout_date.to_date]) %></strong></td>
      <% if person_signed_in? and current_person.id == workout.person.id %>
        <td>
          <% if workout.id %>
            <%= link_to 'Edit', edit_workout_path(workout) %> |
            <%= link_to 'Delete', workout, method: :delete, data: { confirm: 'Are you sure?' } %>
        <% end %>
        </td>
      <% end %>
    </tr>
  <% end %>
</table>
<%= paginate @workouts %>
<br />
